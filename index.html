<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>GramJS Login</title>
    <style>
      body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; margin: 24px; }
      fieldset { border: 1px solid #ddd; border-radius: 8px; padding: 16px; margin: 0 0 16px; }
      legend { padding: 0 8px; color: #333; }
      label { display: block; margin: 8px 0 4px; font-size: 14px; color: #333; }
      input { width: 100%; box-sizing: border-box; padding: 8px 10px; border-radius: 6px; border: 1px solid #ccc; }
      textarea { width: 100%; box-sizing: border-box; padding: 8px 10px; border-radius: 6px; border: 1px solid #ccc; font-family: inherit; }
      button { padding: 8px 12px; border-radius: 6px; border: 1px solid #ccc; background: #f7f7f7; cursor: pointer; }
      button:disabled { opacity: 0.6; cursor: not-allowed; }
      .row { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
      .actions { display: flex; gap: 8px; flex-wrap: wrap; margin-top: 8px; }
      #logWrap { border: 1px solid #eee; background: #fafafa; border-radius: 8px; padding: 12px; }
      #status { font-weight: 600; }
      #log { white-space: pre-wrap; font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; font-size: 12px; line-height: 1.5; max-height: 260px; overflow: auto; margin: 0; }
      small.muted { color: #666; }
      /* Inline checkbox label */
      .checkbox-inline { display: inline-flex; align-items: center; gap: 6px; margin: 0; white-space: nowrap; margin-top: 8px; }
    </style>
  </head>
  <body>
    <h2>OKolo | cherpala</h2>
    <p><small class="muted">Enter your Telegram API credentials. You can authenticate as a user (phone + code [+ password if 2FA])</small></p>

    <fieldset>
      <legend>Account</legend>
      <div class="row">
        <div>
          <div id="meAvatar" style="width:64px;height:64px;border-radius:50%;background:#eee;"></div>
        </div>
        <div>
          <div id="meName"><small class="muted">Not authorized</small></div>
          <div id="meBio" style="color:#666"></div>
        </div>
      </div>
      <div class="actions">
        <button id="connectSaved" type="button">Connect with saved session</button>
        <button id="clearSession" type="button">Clear saved session</button>
      </div>
    </fieldset>
    <fieldset>
      <legend>User Login (Phone)</legend>
      <label for="phone">Phone number (international format, e.g. +15551234567)</label>
      <input id="phone" type="text" placeholder="+15551234567" autocomplete="tel" disabled>

      <div class="row">
        <div>
          <label for="code">Code</label>
          <input id="code" type="text" placeholder="Code from Telegram" autocomplete="one-time-code" disabled>
        </div>
        <div>
          <label for="password">Password (only if 2FA is enabled)</label>
          <input id="password" type="password" placeholder="Your 2FA password" disabled>
        </div>
      </div>

      <div class="actions">
        <button id="startUserLogin" type="button">Start user login</button>
        <button id="submitPhone" type="button" disabled>Submit phone</button>
        <button id="submitCode" type="button" disabled>Submit code</button>
        <button id="submitPassword" type="button" disabled>Submit 2FA password</button>
      </div>
    </fieldset>



    <fieldset>
      <legend>Settings</legend>
      <div class="row">
        <div>
          <label for="searchQuery">Search query</label>
          <input id="searchQuery" type="text" placeholder="e.g. vpn" value="впн">
        </div>
        <div>
          <label for="displayLimit">Display limit (default 1000)</label>
          <input id="displayLimit" type="number" min="50" max="5000" step="50" value="1000">
        </div>
      </div>
      <div class="row">
        <div>
          <label class="checkbox-inline"><input id="hashtagMode" type="checkbox"> hashtag simple search (no tokens consumed) </label>
        </div>
        <div>
          <label for="commentText">Comment text</label>
          <textarea id="commentText" rows="3" placeholder="Your comment to post under items"></textarea>
        </div>
      </div>
      <div class="actions">
        <button id="startSearch" type="button">Start search</button>
        <button id="sendAll" type="button">Send to all (risky)</button>
        <button id="downloadCsv" type="button">Download CSV</button>
        <div id="bulkProgress" style="flex:1; height:10px; background:#eee; border-radius:6px; overflow:hidden; display:none; min-width:160px;">
          <div id="bulkBar" style="height:100%; width:0%; background:#4caf50;"></div>
        </div>
        <span id="bulkLabel" style="display:none; font-size:12px; color:#666;">0 / 0</span>
      </div>
    </fieldset>

    <div id="logWrap" style="margin-bottom: 16px;">
      <div>Connection: <span id="status">idle</span></div>
      <pre id="log"></pre>
    </div>

    <fieldset>
      <legend>Results</legend>
      <div style="overflow:auto; max-height: 60vh; border: 1px solid #eee; border-radius: 8px;">
        <table id="resultsTable" style="width:100%; border-collapse: collapse;">
          <thead style="position: sticky; top: 0; background: #fafafa;">
            <tr>
              <th style="text-align:left; padding: 8px; border-bottom: 1px solid #eee;">Channel</th>
              <th style="text-align:left; padding: 8px; border-bottom: 1px solid #eee;">Msg ID</th>
              <th style="text-align:left; padding: 8px; border-bottom: 1px solid #eee;">Date</th>
              <th style="text-align:left; padding: 8px; border-bottom: 1px solid #eee;">Text</th>
              <th style="text-align:left; padding: 8px; border-bottom: 1px solid #eee;">Link</th>
              <th style="text-align:left; padding: 8px; border-bottom: 1px solid #eee;">Actions</th>
            </tr>
          </thead>
          <tbody id="rows"></tbody>
        </table>
      </div>
      <div id="loading" style="padding:8px; color:#666; display:none;">Loading…</div>
      <div id="endOfList" style="padding:8px; color:#666; display:none;">No more results</div>
    </fieldset>

    <script src="./tg-min.js"></script>
    <script src="./state.js"></script>
    <script src="./utils.js"></script>
    <script src="./auth.js"></script>
    <script src="./ui.js"></script>
    <script src="./comments.js"></script>
    <script src="./search.js"></script>
    <script src="./csv.js"></script>
    <script src="./main.js"></script>
  </body>
</html>


